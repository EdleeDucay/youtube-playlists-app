{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/ducay/Documents/GitHubProjects/youtube-playlists-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/ducay/Documents/GitHubProjects/youtube-playlists-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/ducay/Documents/GitHubProjects/youtube-playlists-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\ducay\\\\Documents\\\\GitHubProjects\\\\youtube-playlists-app\\\\src\\\\components\\\\MyPlaylists.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect, componentDidMount } from 'react';\nimport { Button, Alert, Navbar, Nav, Form, FormControl } from 'react-bootstrap';\nimport \"../styles/Home.css\";\nimport { useAuth } from '../contexts/AuthContext';\nimport { Link, useHistory } from 'react-router-dom';\nimport youtube from '../apis/youtube';\nimport VideoList from './VideoList';\nimport VideoPlayer from './VideoPlayer';\nimport ModalAddPlaylist from './modals/ModalAddPlaylist';\nimport PlaylistItem from './PlaylistItem';\nimport { db } from '../apis/firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function MyPlaylists() {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser,\n      logout = _useAuth.logout;\n\n  var history = useHistory();\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      videos = _useState4[0],\n      setVideos = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      selectedVideo = _useState6[0],\n      setSelectedVideo = _useState6[1];\n\n  var searchRef = useRef();\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      modalShow = _useState8[0],\n      setModalShow = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      playlistTitle = _useState10[0],\n      setPlaylistTitle = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      playlists = _useState12[0],\n      setPlaylists = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      playlistVideos = _useState14[0],\n      setPlaylistVideos = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      loadingVideos = _useState16[0],\n      setLoadingVideos = _useState16[1];\n\n  function handleLogout() {\n    return _handleLogout.apply(this, arguments);\n  }\n\n  function _handleLogout() {\n    _handleLogout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setError('');\n              _context.prev = 1;\n              _context.next = 4;\n              return logout();\n\n            case 4:\n              history.push('/login');\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](1);\n              setError('Failed to log out');\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 7]]);\n    }));\n    return _handleLogout.apply(this, arguments);\n  }\n\n  function handleSubmit(_x) {\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              _context2.next = 3;\n              return youtube.get('/search', {\n                params: {\n                  q: searchRef.current.value\n                }\n              });\n\n            case 3:\n              response = _context2.sent;\n              setVideos(response.data.items);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function handleVideoSelect(video) {\n    setSelectedVideo(video);\n  }\n\n  function onCreatePlaylistSubmit(e) {\n    e.preventDefault();\n    db.collection(\"Users\").doc(currentUser.email).collection(\"Playlists\").doc(playlistTitle).set({\n      'title': playlistTitle\n    });\n    setModalShow(false);\n  }\n\n  useEffect(function () {\n    // Grab current users playlists\n    // const fetchPlaylists = async () => {\n    //     const snapshot = await db.collection('Users').doc(currentUser.email).collection(\"Playlists\").get()\n    //     // console.log(\"SNAPSHOT: \", snapshot.docs)\n    //     setPlaylists(snapshot.docs)\n    // }\n    // fetchPlaylists()\n    db.collection('Users').doc(currentUser.email).collection('Playlists').get().then(function (playlistsSnapshot) {\n      playlistsSnapshot.forEach(function (playlist) {\n        console.log('Playlist: ', playlist);\n        db.collection('Users').doc(currentUser.email).collection('Playlists').doc(playlist.id).collection('Videos').get().then(function (videosSnapshot) {\n          videosSnapshot.forEach(function (video) {\n            console.log('Video: ', video);\n          });\n        });\n      });\n    });\n  }, []); // useEffect(() => {\n  //     if (!loadingVideos && playlistVideos.length !== playlists.length) {\n  //         // Grab the videos in each playlist\n  //         playlists.forEach(playlist => {\n  //             const fetchVideosInPlaylist = async () => {\n  //                 const videos =  await db.collection('Users').doc(currentUser.email).collection('Playlists')\n  //                     .doc(playlist.id).collection('Videos').get()\n  //                 const arr = [{ [playlist.id]: [videos.docs]}]\n  //                 console.log('arr: ', arr)\n  //                 setPlaylistVideos([...playlistVideos, ...arr])\n  //                 setLoadingVideos(true)\n  //             }\n  //             fetchVideosInPlaylist()\n  //         });\n  //     }\n  // })\n  // Bind each playlist to a component\n\n  var renderedPlaylists = playlists.map(function (playlist) {\n    return /*#__PURE__*/_jsxDEV(PlaylistItem, {\n      playlistVideos: playlistVideos\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 16\n    }, _this);\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [error && /*#__PURE__*/_jsxDEV(Alert, {\n      variant: \"danger\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(Navbar, {\n      expand: \"lg\",\n      bg: \"dark\",\n      variant: \"dark\",\n      children: [/*#__PURE__*/_jsxDEV(Navbar.Brand, {\n        className: \"px-3\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          className: \"homeBrand\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"img/Youtube.png\",\n            alt: \"YouTube-Logo\",\n            className: \"youtubeLogoHome\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 17\n          }, this), \"Youtube Custom Playlists\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Navbar.Toggle, {\n        \"aria-controls\": \"responsive-navbar-nav\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Navbar.Collapse, {\n        id: \"responsive-navbar-nav\",\n        children: [/*#__PURE__*/_jsxDEV(Nav, {\n          className: \"me-auto\",\n          children: [/*#__PURE__*/_jsxDEV(Nav.Link, {\n            to: \"/\",\n            className: \"homeLink px-3\",\n            children: \"My Playlists\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Form, {\n            className: \"d-flex px-5\",\n            onSubmit: handleSubmit,\n            children: [/*#__PURE__*/_jsxDEV(FormControl, {\n              type: \"search\",\n              placeholder: \"Search\",\n              className: \"mr-3\",\n              \"aria-label\": \"Search\",\n              ref: searchRef,\n              style: {\n                minWidth: '500px',\n                backgroundColor: 'rgb(50, 50, 50)',\n                color: 'white',\n                borderColor: 'rgb(50, 50, 50)'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"secondary\",\n              onClick: handleSubmit,\n              children: \"Search\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Nav, {\n          children: [/*#__PURE__*/_jsxDEV(Nav.Link, {\n            className: \"px-3 homeEmail\",\n            disabled: true,\n            children: currentUser.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            className: \"mx-3\",\n            onClick: handleLogout,\n            children: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"homeBody\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"secondary\",\n          className: \"myplaylist-create-btn w-25 mt-3\",\n          onClick: function onClick() {\n            return setModalShow(true);\n          },\n          children: \"Create a Custom Playlist\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(ModalAddPlaylist, {\n          show: modalShow,\n          setPlaylistTitle: setPlaylistTitle,\n          onSubmit: onCreatePlaylistSubmit,\n          onHide: function onHide() {\n            return setModalShow(false);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"playlists\",\n        children: renderedPlaylists\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(VideoPlayer, {\n        selectedVideo: selectedVideo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(VideoList, {\n        handleVideoSelect: handleVideoSelect,\n        videos: videos\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_s(MyPlaylists, \"mOE3Q8bnSoKFlo30pgg/3Y3V7Hg=\", false, function () {\n  return [useAuth, useHistory];\n});\n\n_c = MyPlaylists;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyPlaylists\");","map":{"version":3,"sources":["C:/Users/ducay/Documents/GitHubProjects/youtube-playlists-app/src/components/MyPlaylists.js"],"names":["React","useState","useRef","useEffect","componentDidMount","Button","Alert","Navbar","Nav","Form","FormControl","useAuth","Link","useHistory","youtube","VideoList","VideoPlayer","ModalAddPlaylist","PlaylistItem","db","MyPlaylists","error","setError","currentUser","logout","history","videos","setVideos","selectedVideo","setSelectedVideo","searchRef","modalShow","setModalShow","playlistTitle","setPlaylistTitle","playlists","setPlaylists","playlistVideos","setPlaylistVideos","loadingVideos","setLoadingVideos","handleLogout","push","handleSubmit","e","preventDefault","get","params","q","current","value","response","data","items","handleVideoSelect","video","onCreatePlaylistSubmit","collection","doc","email","set","then","playlistsSnapshot","forEach","playlist","console","log","id","videosSnapshot","renderedPlaylists","map","minWidth","backgroundColor","color","borderColor"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAeC,QAAf,EAAyBC,MAAzB,EAAiCC,SAAjC,EAA4CC,iBAA5C,QAAoE,OAApE;AACA,SAAQC,MAAR,EAAgBC,KAAhB,EAAuBC,MAAvB,EAA+BC,GAA/B,EAAoCC,IAApC,EAA0CC,WAA1C,QAA4D,iBAA5D;AACA,OAAO,oBAAP;AACA,SAAQC,OAAR,QAAsB,yBAAtB;AACA,SAASC,IAAT,EAAeC,UAAf,QAAiC,kBAAjC;AACA,OAAOC,OAAP,MAAoB,iBAApB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,gBAAP,MAA6B,2BAA7B;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,SAAQC,EAAR,QAAiB,kBAAjB;;;AAEA,eAAe,SAASC,WAAT,GAAuB;AAAA;;AAAA;;AAAA,kBACRnB,QAAQ,CAAC,EAAD,CADA;AAAA;AAAA,MAC3BoB,KAD2B;AAAA,MACpBC,QADoB;;AAAA,iBAEJX,OAAO,EAFH;AAAA,MAE3BY,WAF2B,YAE3BA,WAF2B;AAAA,MAEdC,MAFc,YAEdA,MAFc;;AAGlC,MAAMC,OAAO,GAAGZ,UAAU,EAA1B;;AAHkC,mBAINZ,QAAQ,CAAC,EAAD,CAJF;AAAA;AAAA,MAI3ByB,MAJ2B;AAAA,MAInBC,SAJmB;;AAAA,mBAKQ1B,QAAQ,CAAC,IAAD,CALhB;AAAA;AAAA,MAK3B2B,aAL2B;AAAA,MAKZC,gBALY;;AAMlC,MAAMC,SAAS,GAAG5B,MAAM,EAAxB;;AANkC,mBAOAD,QAAQ,CAAC,KAAD,CAPR;AAAA;AAAA,MAO3B8B,SAP2B;AAAA,MAOhBC,YAPgB;;AAAA,mBAQQ/B,QAAQ,CAAC,EAAD,CARhB;AAAA;AAAA,MAQ3BgC,aAR2B;AAAA,MAQZC,gBARY;;AAAA,oBASAjC,QAAQ,CAAC,EAAD,CATR;AAAA;AAAA,MAS3BkC,SAT2B;AAAA,MAShBC,YATgB;;AAAA,oBAUUnC,QAAQ,CAAC,EAAD,CAVlB;AAAA;AAAA,MAU3BoC,cAV2B;AAAA,MAUXC,iBAVW;;AAAA,oBAWQrC,QAAQ,CAAC,KAAD,CAXhB;AAAA;AAAA,MAW3BsC,aAX2B;AAAA,MAWZC,gBAXY;;AAAA,WAanBC,YAbmB;AAAA;AAAA;;AAAA;AAAA,6EAalC;AAAA;AAAA;AAAA;AAAA;AACInB,cAAAA,QAAQ,CAAC,EAAD,CAAR;AADJ;AAAA;AAAA,qBAIcE,MAAM,EAJpB;;AAAA;AAKQC,cAAAA,OAAO,CAACiB,IAAR,CAAa,QAAb;AALR;AAAA;;AAAA;AAAA;AAAA;AAOQpB,cAAAA,QAAQ,CAAC,mBAAD,CAAR;;AAPR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAbkC;AAAA;AAAA;;AAAA,WAwBnBqB,YAxBmB;AAAA;AAAA;;AAAA;AAAA,6EAwBlC,kBAA4BC,CAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AACIA,cAAAA,CAAC,CAACC,cAAF;AADJ;AAAA,qBAG2B/B,OAAO,CAACgC,GAAR,CAAY,SAAZ,EAAuB;AAC1CC,gBAAAA,MAAM,EAAE;AACJC,kBAAAA,CAAC,EAAElB,SAAS,CAACmB,OAAV,CAAkBC;AADjB;AADkC,eAAvB,CAH3B;;AAAA;AAGUC,cAAAA,QAHV;AAQIxB,cAAAA,SAAS,CAACwB,QAAQ,CAACC,IAAT,CAAcC,KAAf,CAAT;;AARJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAxBkC;AAAA;AAAA;;AAoClC,WAASC,iBAAT,CAA2BC,KAA3B,EAAkC;AAC9B1B,IAAAA,gBAAgB,CAAC0B,KAAD,CAAhB;AACH;;AAED,WAASC,sBAAT,CAAgCZ,CAAhC,EAAmC;AAC/BA,IAAAA,CAAC,CAACC,cAAF;AAEA1B,IAAAA,EAAE,CAACsC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BnC,WAAW,CAACoC,KAAvC,EAA8CF,UAA9C,CAAyD,WAAzD,EAAsEC,GAAtE,CAA0EzB,aAA1E,EAAyF2B,GAAzF,CAA6F;AACzF,eAAS3B;AADgF,KAA7F;AAGAD,IAAAA,YAAY,CAAC,KAAD,CAAZ;AACH;;AAED7B,EAAAA,SAAS,CAAC,YAAM;AACZ;AACA;AACA;AACA;AACA;AAGA;AAEA;AAEAgB,IAAAA,EAAE,CAACsC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BnC,WAAW,CAACoC,KAAvC,EAA8CF,UAA9C,CAAyD,WAAzD,EACKX,GADL,GAEKe,IAFL,CAEU,UAACC,iBAAD,EAAuB;AACzBA,MAAAA,iBAAiB,CAACC,OAAlB,CAA0B,UAACC,QAAD,EAAc;AACpCC,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BF,QAA1B;AAEA7C,QAAAA,EAAE,CAACsC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BnC,WAAW,CAACoC,KAAvC,EAA8CF,UAA9C,CAAyD,WAAzD,EAAsEC,GAAtE,CAA0EM,QAAQ,CAACG,EAAnF,EAAuFV,UAAvF,CAAkG,QAAlG,EACKX,GADL,GAEKe,IAFL,CAEU,UAACO,cAAD,EAAoB;AACtBA,UAAAA,cAAc,CAACL,OAAf,CAAuB,UAACR,KAAD,EAAW;AAC9BU,YAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBX,KAAvB;AACH,WAFD;AAGH,SANL;AAQH,OAXD;AAYH,KAfL;AAiBH,GA7BQ,EA6BN,EA7BM,CAAT,CAjDkC,CAgFlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAGA;;AACA,MAAMc,iBAAiB,GAAGlC,SAAS,CAACmC,GAAV,CAAc,UAACN,QAAD,EAAc;AAClD,wBAAO,QAAC,YAAD;AAAc,MAAA,cAAc,EAAE3B;AAA9B;AAAA;AAAA;AAAA;AAAA,aAAP;AACH,GAFyB,CAA1B;AAMA,sBACI;AAAA,eACChB,KAAK,iBAAI,QAAC,KAAD;AAAO,MAAA,OAAO,EAAC,QAAf;AAAA,gBAAyBA;AAAzB;AAAA;AAAA;AAAA;AAAA,YADV,eAEA,QAAC,MAAD;AAAQ,MAAA,MAAM,EAAC,IAAf;AAAoB,MAAA,EAAE,EAAC,MAAvB;AAA8B,MAAA,OAAO,EAAC,MAAtC;AAAA,8BAEI,QAAC,MAAD,CAAQ,KAAR;AAAc,QAAA,SAAS,EAAC,MAAxB;AAAA,+BACI,QAAC,IAAD;AAAM,UAAA,EAAE,EAAC,GAAT;AAAa,UAAA,SAAS,EAAC,WAAvB;AAAA,kCACA;AAAK,YAAA,GAAG,EAAC,iBAAT;AAA2B,YAAA,GAAG,EAAC,cAA/B;AAA8C,YAAA,SAAS,EAAC;AAAxD;AAAA;AAAA;AAAA;AAAA,kBADA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAFJ,eAQI,QAAC,MAAD,CAAQ,MAAR;AAAe,yBAAc;AAA7B;AAAA;AAAA;AAAA;AAAA,cARJ,eASI,QAAC,MAAD,CAAQ,QAAR;AAAiB,QAAA,EAAE,EAAC,uBAApB;AAAA,gCACA,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,SAAf;AAAA,kCACI,QAAC,GAAD,CAAK,IAAL;AAAU,YAAA,EAAE,EAAC,GAAb;AAAiB,YAAA,SAAS,EAAC,eAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,IAAD;AAAM,YAAA,SAAS,EAAC,aAAhB;AAA8B,YAAA,QAAQ,EAAEsB,YAAxC;AAAA,oCACI,QAAC,WAAD;AACI,cAAA,IAAI,EAAC,QADT;AAEI,cAAA,WAAW,EAAC,QAFhB;AAGI,cAAA,SAAS,EAAC,MAHd;AAII,4BAAW,QAJf;AAKI,cAAA,GAAG,EAAGb,SALV;AAMI,cAAA,KAAK,EAAE;AAACyC,gBAAAA,QAAQ,EAAE,OAAX;AACHC,gBAAAA,eAAe,EAAE,iBADd;AAEHC,gBAAAA,KAAK,EAAE,OAFJ;AAGHC,gBAAAA,WAAW,EAAE;AAHV;AANX;AAAA;AAAA;AAAA;AAAA,oBADJ,eAYI,QAAC,MAAD;AAAQ,cAAA,OAAO,EAAC,WAAhB;AAA4B,cAAA,OAAO,EAAE/B,YAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAZJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBADA,eAmBA,QAAC,GAAD;AAAA,kCACI,QAAC,GAAD,CAAK,IAAL;AAAU,YAAA,SAAS,EAAC,gBAApB;AAAqC,YAAA,QAAQ,MAA7C;AAAA,sBAA+CpB,WAAW,CAACoC;AAA3D;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAC,WAAhB;AAA4B,YAAA,SAAS,EAAC,MAAtC;AAA6C,YAAA,OAAO,EAAElB,YAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAnBA;AAAA;AAAA;AAAA;AAAA;AAAA,cATJ;AAAA;AAAA;AAAA;AAAA;AAAA,YAFA,eAyCA;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA,8BAEI;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA,gCACI,QAAC,MAAD;AAAQ,UAAA,OAAO,EAAC,WAAhB;AAA4B,UAAA,SAAS,EAAC,iCAAtC;AAAwE,UAAA,OAAO,EAAE;AAAA,mBAAMT,YAAY,CAAC,IAAD,CAAlB;AAAA,WAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAKY,QAAC,gBAAD;AACA,UAAA,IAAI,EAAED,SADN;AAEA,UAAA,gBAAgB,EAAEG,gBAFlB;AAGA,UAAA,QAAQ,EAAEsB,sBAHV;AAIA,UAAA,MAAM,EAAE;AAAA,mBAAMxB,YAAY,CAAC,KAAD,CAAlB;AAAA;AAJR;AAAA;AAAA;AAAA;AAAA,gBALZ;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,eAcI;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,kBACKqC;AADL;AAAA;AAAA;AAAA;AAAA,cAdJ,eAmBI,QAAC,WAAD;AAAa,QAAA,aAAa,EAAEzC;AAA5B;AAAA;AAAA;AAAA;AAAA,cAnBJ,eAoBI,QAAC,SAAD;AAAW,QAAA,iBAAiB,EAAE0B,iBAA9B;AAAiD,QAAA,MAAM,EAAE5B;AAAzD;AAAA;AAAA;AAAA;AAAA,cApBJ;AAAA;AAAA;AAAA;AAAA;AAAA,YAzCA;AAAA,kBADJ;AAoEH;;GA/KuBN,W;UAEUT,O,EACdE,U;;;KAHIO,W","sourcesContent":["import React, {useState, useRef, useEffect, componentDidMount} from 'react'\r\nimport {Button, Alert, Navbar, Nav, Form, FormControl} from 'react-bootstrap'\r\nimport \"../styles/Home.css\"\r\nimport {useAuth} from '../contexts/AuthContext'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport youtube from '../apis/youtube'\r\nimport VideoList from './VideoList'\r\nimport VideoPlayer from './VideoPlayer'\r\nimport ModalAddPlaylist from './modals/ModalAddPlaylist' \r\nimport PlaylistItem from './PlaylistItem'\r\nimport {db} from '../apis/firebase'\r\n\r\nexport default function MyPlaylists() {\r\n    const [error, setError] = useState('')\r\n    const {currentUser, logout} = useAuth()\r\n    const history = useHistory()\r\n    const [videos, setVideos] = useState([])\r\n    const [selectedVideo, setSelectedVideo] = useState(null)\r\n    const searchRef = useRef()\r\n    const [modalShow, setModalShow] = useState(false);\r\n    const [playlistTitle, setPlaylistTitle] = useState('')\r\n    const [playlists, setPlaylists] = useState([])\r\n    const [playlistVideos, setPlaylistVideos] = useState([])\r\n    const [loadingVideos, setLoadingVideos] = useState(false)\r\n\r\n    async function handleLogout() {\r\n        setError('')\r\n\r\n        try {\r\n            await logout()\r\n            history.push('/login')\r\n        } catch {\r\n            setError('Failed to log out')\r\n        }\r\n    }\r\n\r\n    async function handleSubmit(e) {\r\n        e.preventDefault();\r\n\r\n        const response = await youtube.get('/search', {\r\n            params: {\r\n                q: searchRef.current.value\r\n            }\r\n        })\r\n        setVideos(response.data.items)\r\n\r\n    }\r\n\r\n    function handleVideoSelect(video) {\r\n        setSelectedVideo(video)\r\n    }\r\n\r\n    function onCreatePlaylistSubmit(e) {\r\n        e.preventDefault();\r\n        \r\n        db.collection(\"Users\").doc(currentUser.email).collection(\"Playlists\").doc(playlistTitle).set({\r\n            'title': playlistTitle\r\n        })\r\n        setModalShow(false);\r\n    }\r\n\r\n    useEffect(() => {\r\n        // Grab current users playlists\r\n        // const fetchPlaylists = async () => {\r\n        //     const snapshot = await db.collection('Users').doc(currentUser.email).collection(\"Playlists\").get()\r\n        //     // console.log(\"SNAPSHOT: \", snapshot.docs)\r\n        //     setPlaylists(snapshot.docs)\r\n\r\n            \r\n        // }\r\n\r\n        // fetchPlaylists()\r\n\r\n        db.collection('Users').doc(currentUser.email).collection('Playlists')\r\n            .get()\r\n            .then((playlistsSnapshot) => {\r\n                playlistsSnapshot.forEach((playlist) => {\r\n                    console.log('Playlist: ', playlist)\r\n\r\n                    db.collection('Users').doc(currentUser.email).collection('Playlists').doc(playlist.id).collection('Videos')\r\n                        .get()\r\n                        .then((videosSnapshot) => {\r\n                            videosSnapshot.forEach((video) => {\r\n                                console.log('Video: ', video)\r\n                            })\r\n                        })\r\n\r\n                })\r\n            })\r\n\r\n    }, []);\r\n\r\n    // useEffect(() => {\r\n    //     if (!loadingVideos && playlistVideos.length !== playlists.length) {\r\n    //         // Grab the videos in each playlist\r\n    //         playlists.forEach(playlist => {\r\n    //             const fetchVideosInPlaylist = async () => {\r\n    //                 const videos =  await db.collection('Users').doc(currentUser.email).collection('Playlists')\r\n    //                     .doc(playlist.id).collection('Videos').get()\r\n    //                 const arr = [{ [playlist.id]: [videos.docs]}]\r\n    //                 console.log('arr: ', arr)\r\n    //                 setPlaylistVideos([...playlistVideos, ...arr])\r\n    //                 setLoadingVideos(true)\r\n    //             }\r\n    //             fetchVideosInPlaylist()\r\n    //         });\r\n    //     }\r\n\r\n        \r\n    // })\r\n\r\n\r\n    // Bind each playlist to a component\r\n    const renderedPlaylists = playlists.map((playlist) => {\r\n        return <PlaylistItem playlistVideos={playlistVideos}/>\r\n    })\r\n \r\n    \r\n\r\n    return (\r\n        <>\r\n        {error && <Alert variant='danger'>{error}</Alert>}\r\n        <Navbar expand=\"lg\" bg=\"dark\" variant=\"dark\">\r\n\r\n            <Navbar.Brand className=\"px-3\">\r\n                <Link to=\"/\" className=\"homeBrand\">\r\n                <img src='img/Youtube.png' alt='YouTube-Logo' className='youtubeLogoHome'/>\r\n                        Youtube Custom Playlists\r\n                </Link>\r\n            </Navbar.Brand>\r\n            <Navbar.Toggle aria-controls=\"responsive-navbar-nav\" />\r\n            <Navbar.Collapse id=\"responsive-navbar-nav\">\r\n            <Nav className=\"me-auto\">\r\n                <Nav.Link to=\"/\" className=\"homeLink px-3\">My Playlists</Nav.Link>\r\n                <Form className=\"d-flex px-5\" onSubmit={handleSubmit}>\r\n                    <FormControl\r\n                        type=\"search\"\r\n                        placeholder=\"Search\"\r\n                        className=\"mr-3\"\r\n                        aria-label=\"Search\"\r\n                        ref= {searchRef}\r\n                        style={{minWidth: '500px', \r\n                            backgroundColor: 'rgb(50, 50, 50)',\r\n                            color: 'white',\r\n                            borderColor: 'rgb(50, 50, 50)'}}\r\n                    />\r\n                    <Button variant=\"secondary\" onClick={handleSubmit}>Search</Button>\r\n                </Form>\r\n            </Nav>\r\n            \r\n            <Nav >\r\n                <Nav.Link className=\"px-3 homeEmail\" disabled>{currentUser.email}</Nav.Link>\r\n                <Button variant=\"secondary\" className=\"mx-3\" onClick={handleLogout}>Logout</Button>\r\n\r\n            </Nav>\r\n            </Navbar.Collapse>\r\n        \r\n        </Navbar>\r\n\r\n       \r\n       \r\n        <div className=\"homeBody\">\r\n\r\n            <div className=\"text-center\">\r\n                <Button variant=\"secondary\" className=\"myplaylist-create-btn w-25 mt-3\" onClick={() => setModalShow(true)}>\r\n                        Create a Custom Playlist\r\n                        </Button>\r\n                \r\n                        <ModalAddPlaylist\r\n                        show={modalShow}\r\n                        setPlaylistTitle={setPlaylistTitle}\r\n                        onSubmit={onCreatePlaylistSubmit}\r\n                        onHide={() => setModalShow(false)}/>\r\n            </div>\r\n        \r\n            <div className=\"playlists\">\r\n                {renderedPlaylists}\r\n            </div>\r\n\r\n\r\n            <VideoPlayer selectedVideo={selectedVideo}/>\r\n            <VideoList handleVideoSelect={handleVideoSelect} videos={videos}/>\r\n        </div>\r\n        \r\n        </>\r\n       \r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}